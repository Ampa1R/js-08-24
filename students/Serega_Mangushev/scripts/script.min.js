"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function getSumObj(object,expression){return eval(expression.replace(/[a-z]+/gi,function(e){return object[e]}))}var xhr=new XMLHttpRequest,root="https://raw.githubusercontent.com/Binatik/js-08-24/master/students/Serega_Mangushev/backend/Server";function promisifiedXHR(n,r,o){return new Promise(function(e,t){xhr.onreadystatechange=function(){4===xhr.readyState&&e(JSON.parse(xhr.responseText))},xhr.open(n,"".concat(r+o),!0),xhr.send()})}var ProductСard=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,t),this.id=e.id,this.count=e.count,this.image=e.image,this.name=e.name,this.price=e.price}return _createClass(t,[{key:"getComponent",value:function(e){return e}}]),t}(),Goods=function(){function e(){_classCallCheck(this,e),this.getVariables(),this.getGoods()}return _createClass(e,[{key:"getVariables",value:function(){this.products=document.querySelector(".shop__list"),this.maxNumPrice=document.querySelector(".shop__max-price"),this.sum=0,this.goods=[]}},{key:"getGoods",value:function(){var t=this;promisifiedXHR("GET",root,"/goods.json").then(function(e){t.goods=e,t.sum=t.goods.reduce(function(e,t){return e+getSumObj(t,"count * price")},0),t.maxNumPrice.innerHTML="Общая цена товаров на сумму: ".concat(t.sum," Руб"),t.render(),new Basket})}},{key:"render",value:function(){var e=this.goods.map(function(e){var t=new ProductСard(e);return t.getComponent([' <div class="shop__product product">\n                <img class="product__img" src="'.concat(t.image,'" alt="Черное">\n                <div class="product__group">\n                    <p class="product-description">').concat(t.name,'</p>  \n                    <span class="product__price">').concat(t.price,' Р</span> \n                    <button class="product__btn btn">Заказать</button>\n                </div>\n            </div>')])}).join("");this.products.innerHTML=e}}]),e}(),productСard=new Goods,Basket=function(){function e(){_classCallCheck(this,e),this.goods=productСard.goods,this.products=[],this.addProduct(2),this.addProduct(1),this.removeProduct(1)}return _createClass(e,[{key:"addProduct",value:function(t){this.products.push(this.goods.find(function(e){return e.id===t})),this.sum=this.goods.reduce(function(e,t){return e+getSumObj(t,"price")},0),console.log("Сумма товаров: "+this.sum)}},{key:"removeProduct",value:function(t){this.products.splice(this.products.findIndex(function(e){return e.id===t}))}}]),e}();